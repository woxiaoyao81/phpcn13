<!--
 * @Descripttion: 
 * @version: 
 * @Author: woxiaoyao
 * @Date: 2020-11-07 13:06:44
 * @LastEditTime: 2020-11-07 15:01:37
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JS实战案例:图片的懒加载</title>
    <style>
      .container {
        width: 500px;
        display: grid;
        gap: 10px;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }
      .container img {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <img src="images/temp.jpg" alt="" data-src="images/img-1.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-2.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-3.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-4.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-5.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-6.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-7.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-8.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-9.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-10.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-11.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-12.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-13.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-14.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-15.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-16.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-17.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-18.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-19.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-20.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-21.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-22.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-23.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-24.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-25.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-26.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-27.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-28.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-29.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-30.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-31.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-32.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-33.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-34.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-35.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-36.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-37.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-38.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-39.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-40.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-41.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-42.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-43.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-44.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-45.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-46.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-47.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-48.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-49.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-50.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-51.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-52.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-53.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-54.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-55.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-56.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-57.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-58.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-59.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-60.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-61.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-62.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-63.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-64.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-65.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-66.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-67.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-68.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-69.jpg" />
      <img src="images/temp.jpg" alt="" data-src="images/img-70.jpg" />
    </div>
  </body>
<script>
  const imgs = document.querySelectorAll('.container img');
  // 视口高度，即可视区域高度
  const clientHeight = document.documentElement.clientHeight;

  window.addEventListener('scroll', lazy, false);
  window.addEventListener('load', lazy, false);

  function lazy(ev) {
    // 滚动高度，可视区域滚动过的距离
    let scrollTop = document.documentElement.scrollTop;
    for (let img of imgs) {
      // 元素在文档中偏移高度,也可称为真实高度
      let offsetTop = img.offsetTop;
      // 当元素偏移高度小于（视口高度+滚动高度）时，元素就出现在可视区域了
      if (offsetTop <= scrollTop + clientHeight) {
        setTimeout(() => (img.src = img.dataset.src), 500);
      }
    }
  }
</script>
</html>
